<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="category_whatsapp" model="ir.module.category">
        <field name="name">WhatsApp</field>
        <field name="description">WhatsApp Management</field>
    </record>

    <record id="group_whatsapp_admin" model="res.groups">
        <field name="name">WhatsApp Administrator</field>
        <field name="category_id" ref="category_whatsapp"/>
        <field name="users" eval="[(4, ref('base.user_admin'))]"/>
    </record>

    <record id="group_whatsapp_user" model="res.groups">
        <field name="name">WhatsApp User</field>
        <field name="category_id" ref="category_whatsapp"/>
    </record>

    <!-- Record rules for data access control -->
    <!-- Simple rules that will be enforced by Python model methods -->
    <record id="whatsapp_configuration_rule" model="ir.rule">
        <field name="name">WhatsApp Configuration Access Rule</field>
        <field name="model_id" ref="model_whatsapp_configuration"/>
        <field name="domain_force">['|', ('user_ids', 'in', [user.id]), ('group_ids', 'in', [g.id for g in user.groups_id])]</field>
        <field name="groups" eval="[(4, ref('group_whatsapp_user'))]"/>
    </record>

    <!-- Admin rule - admins see all configurations and related data -->
    <record id="whatsapp_configuration_admin_rule" model="ir.rule">
        <field name="name">WhatsApp Configuration Admin Rule</field>
        <field name="model_id" ref="model_whatsapp_configuration"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_whatsapp_admin'))]"/>
    </record>

    <record id="whatsapp_contact_admin_rule" model="ir.rule">
        <field name="name">WhatsApp Contact Admin Rule</field>
        <field name="model_id" ref="model_whatsapp_contact"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_whatsapp_admin'))]"/>
    </record>

    <record id="whatsapp_group_admin_rule" model="ir.rule">
        <field name="name">WhatsApp Group Admin Rule</field>
        <field name="model_id" ref="model_whatsapp_group"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_whatsapp_admin'))]"/>
    </record>

    <record id="whatsapp_message_admin_rule" model="ir.rule">
        <field name="name">WhatsApp Message Admin Rule</field>
        <field name="model_id" ref="model_whatsapp_message"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('group_whatsapp_admin'))]"/>
    </record>
</odoo>
